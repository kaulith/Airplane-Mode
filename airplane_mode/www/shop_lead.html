<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf_token" content="{{ csrf_token }}">
    <title>Shop Lead Form - Airport Shop Management</title>
    <style>
        html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}body{margin:0}article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section,summary{display:block}audio,canvas,progress,video{display:inline-block;vertical-align:baseline}audio:not([controls]){display:none;height:0}[hidden],template{display:none}a{background:transparent}a:active,a:hover{outline:0}abbr[title]{border-bottom:1px dotted}b,strong{font-weight:bold}dfn{font-style:italic}h1{font-size:2em;margin:.67em 0}mark{background:#fff;color:#111}small{font-size:80%}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}sup{top:-0.5em}sub{bottom:-0.25em}img{border:0}svg:not(:root){overflow:hidden}figure{margin:1em 40px}hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}pre{overflow:auto}code,kbd,pre,samp{font-family:monospace,monospace;font-size:1em}button,input,optgroup,select,textarea{color:inherit;font:inherit;margin:0}button{overflow:visible}button,select{text-transform:none}button,html input[type=button],input[type=reset],input[type=submit]{-webkit-appearance:button;cursor:pointer}button[disabled],input[disabled]{cursor:default}button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}input{line-height:normal}input[type=checkbox],[type=radio]{box-sizing:border-box;padding:0}input[type=number]::-webkit-inner-spin-button,input[type=number]::-webkit-outer-spin-button{height:auto}input[type=search]::-webkit-search-cancel-button,input[type=search]::-webkit-search-decoration{-webkit-appearance:none}fieldset{border:0;padding:0}legend{border:0;padding:0}textarea{overflow:auto}optgroup{font-weight:bold}table{border-collapse:collapse;border-spacing:0}td,th{padding:0}*{box-sizing:inherit}html,body{font-family:'Segoe UI',Tahoma,Geneva,Verdana,sans-serif;box-sizing:border-box;height:100%}body{color:#2c3e50;font-size:1em;line-height:1.6;background:#f8f9fa}main{display:block}h1,h2,h3,h4,h5,h6{margin:0;padding:.6em 0;color:#2c3e50}li{margin:0 0 .3em}a{color:#0074d9;text-decoration:none;box-shadow:none;transition:all .3s}code{padding:.3em .6em;font-size:.8em;background:#f5f5f5}pre{text-align:left;padding:.3em;background:#f5f5f5;border-radius:.2em}pre code{padding:0}blockquote{padding:0 0 0 1em;margin:0 0 0 .1em;box-shadow:inset 5px 0 rgba(0,116,217,.3)}label{cursor:pointer}[class^=icon-]:before,[class*=" icon-"]:before{margin:0 .6em 0 0}i[class^=icon-]:before,i[class*=" icon-"]:before{margin:0}.dropimage,button,.button,[type=submit],.label,[data-tooltip]:after{display:inline-block;text-align:center;letter-spacing:inherit;margin:0;padding:.3em .9em;vertical-align:middle;background:#0074d9;color:#fff;border:0;border-radius:.4em;width:auto;-webkit-touch-callout:none;-webkit-user-select:none;-khtml-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;font-weight:600}.success.dropimage,button.success,.success.button,.success[type=submit],.success.label,.success[data-tooltip]:after{background:#27ae60}.warning.dropimage,button.warning,.warning.button,.warning[type=submit],.warning.label,.warning[data-tooltip]:after{background:#f39c12}.error.dropimage,button.error,.error.button,.error[type=submit],.error.label,.error[data-tooltip]:after{background:#e74c3c}.pseudo.dropimage,button.pseudo,.pseudo.button,.pseudo[type=submit],.pseudo.label,.pseudo[data-tooltip]:after{background-color:transparent;color:inherit}.label,[data-tooltip]:after{font-size:.6em;padding:.4em .6em;margin-left:1em;line-height:1}.dropimage,button,.button,[type=submit]{margin:.3em 0;cursor:pointer;transition:all .3s;border-radius:.4em;height:auto;vertical-align:baseline;box-shadow:0 2px 8px rgba(0,116,217,.15)}.dropimage:hover,button:hover,.button:hover,[type=submit]:hover,.dropimage:focus,button:focus,.button:focus,[type=submit]:focus{box-shadow:0 4px 12px rgba(0,116,217,.3);transform:translateY(-2px)}.pseudo.dropimage:hover,button.pseudo:hover,.pseudo.button:hover,.pseudo[type=submit]:hover,.pseudo.dropimage:focus,button.pseudo:focus,.pseudo.button:focus,.pseudo[type=submit]:focus{box-shadow:inset 0 0 0 99em rgba(17,17,17,.1)}.active.dropimage,button.active,.active.button,.active[type=submit],.dropimage:active,button:active,.button:active,[type=submit]:active{box-shadow:inset 0 0 0 99em rgba(17,17,17,.2)}[disabled].dropimage,button[disabled],[disabled].button,[disabled][type=submit]{cursor:default;box-shadow:none;background:#95a5a6}:checked+.toggle,:checked+.toggle:hover{box-shadow:inset 0 0 0 99em rgba(17,17,17,.2)}[type]+.toggle{padding:.3em .9em;margin-right:0}[type]+.toggle:after,[type]+.toggle:before{display:none}input,textarea,.select select{line-height:1.5;margin:0;height:2.1em;padding:.3em .6em;border:1px solid #bdc3c7;background-color:#fff;border-radius:.4em;transition:all .3s;width:100%}input:focus,textarea:focus,.select select:focus{border:1px solid #0074d9;outline:0;box-shadow:0 0 0 3px rgba(0,116,217,.1)}textarea{height:auto}[type=file],[type=color]{cursor:pointer}[type=file]{height:auto}select{background:#fff url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyIiBoZWlnaHQ9IjMiPjxwYXRoIGQ9Im0gMCwxIDEsMiAxLC0yIHoiIGZpbGw9IiMwMDAwIi8+PC9zdmc+) no-repeat scroll 95% center/10px 15px;background-position:calc(100% - 15px) center;border:1px solid #bdc3c7;border-radius:.4em;cursor:pointer;width:100%;height:2.2em;box-sizing:border-box;padding:.3em .45em;transition:all .3s;-moz-appearance:none;-webkit-appearance:none;appearance:none}select::-ms-expand{display:none}select:focus,select:active{border:1px solid #0074d9;transition:outline 0s;box-shadow:0 0 0 3px rgba(0,116,217,.1)}select:-moz-focusring{color:transparent;text-shadow:0 0 0 #111}select option{font-size:inherit;padding:.45em}select[multiple]{height:auto;background:none;padding:0}[type=checkbox],[type=radio]{opacity:0;width:0;position:absolute;display:inline-block}[type=checkbox]+.checkable:hover:before,[type=radio]+.checkable:hover:before,[type=checkbox]:focus+.checkable:before,[type=radio]:focus+.checkable:before{border:1px solid #0074d9}[type=checkbox]+.checkable,[type=radio]+.checkable{position:relative;cursor:pointer;padding-left:1.5em;margin-right:.6em}[type=checkbox]+.checkable:before,[type=radio]+.checkable:before,[type=checkbox]+.checkable:after,[type=radio]+.checkable:after{content:"";position:absolute;display:inline-block;left:0;top:50%;transform:translateY(-50%);font-size:1em;line-height:1em;color:transparent;font-family:sans;text-align:center;box-sizing:border-box;width:1em;height:1em;border-radius:50%;transition:all .3s}[type=checkbox]+.checkable:before,[type=radio]+.checkable:before{border:1px solid #bdc3c7}[type=checkbox]:checked+.checkable:after,[type=radio]:checked+.checkable:after{background:#0074d9;transform:scale(0.5) translateY(-100%)}[type=checkbox]+.checkable:before{border-radius:.2em}[type=checkbox]+.checkable:after{content:"‚úî";background:none;transform:scale(2) translateY(-25%);visibility:hidden;opacity:0;color:#fff}[type=checkbox]:checked+.checkable:after{color:#fff;background:none;transform:translateY(-50%);transition:all .3s;visibility:visible;opacity:1}
        body { padding-top: 3em; }
        .breadcrumb { padding: 1em 1.5em; background: #ecf0f1; border-bottom: 1px solid #bdc3c7; }
        .breadcrumb a { color: #0074d9; font-weight: 500; }
        .portal-header {
            background: linear-gradient(135deg, #0074d9 0%, #0059a8 100%);
            color: white;
            padding: 2.5em;
            text-align: center;
            margin-bottom: 2em;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }
        .portal-header h1 { margin: 0; font-size: 2.2em; font-weight: 700; }
        .portal-header p { margin: 0.5em 0 0 0; font-size: 1.05em; opacity: 0.95; }
        .main-content { padding: 2em 1em; background: #f8f9fa; }
        .content-container { max-width: 1100px; margin: 0 auto; }
        .form-grid { display: grid; grid-template-columns: 2fr 1fr; gap: 2.5em; }
        .form-card { border: none; border-radius: 0.6em; padding: 2em; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.08); }
        .form-group { margin-bottom: 1.5em; }
        .form-group label { display: block; font-weight: 700; margin-bottom: 0.5em; color: #2c3e50; font-size: 0.95em; }
        .form-group input,
        .form-group textarea,
        .form-group select { width: 100%; box-sizing: border-box; }
        .form-group textarea { resize: vertical; min-height: 120px; }
        .shop-sidebar { border: none; border-radius: 0.6em; padding: 1.8em; background: #ecf0f1; box-shadow: 0 1px 4px rgba(0,0,0,0.05); }
        .shop-sidebar h3 { margin-top: 0; color: #2c3e50; font-size: 1.1em; }
        .shop-info-row { display: flex; justify-content: space-between; padding: 0.7em 0; border-bottom: 1px solid #bdc3c7; font-size: 0.95em; }
        .shop-info-label { font-weight: 700; color: #7f8c8d; }
        .shop-info-value { color: #2c3e50; text-align: right; font-weight: 500; }
        .status-badge {
            display: inline-block;
            padding: 0.5em 1em;
            border-radius: 0.3em;
            font-size: 0.85em;
            font-weight: 700;
            margin-top: 0.8em;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        .status-available { background: #27ae60; color: white; }
        .status-occupied { background: #f39c12; color: white; }
        .status-maintenance { background: #95a5a6; color: white; }
        .submit-btn { width: 100%; padding: 1em; background: #0074d9; color: white; border: 0; border-radius: 0.4em; font-weight: 700; cursor: pointer; font-size: 1em; box-shadow: 0 2px 8px rgba(0,116,217,.15); transition: all 0.3s ease; }
        .submit-btn:hover { background: #0059a8; box-shadow: 0 4px 12px rgba(0,116,217,.3); transform: translateY(-2px); }
        .submit-btn:disabled { background: #95a5a6; cursor: default; }
        .success-message { 
            display: none; 
            padding: 2em; 
            background: #27ae60; 
            color: white; 
            border-radius: 0.6em; 
            margin-top: 2em;
            text-align: center;
            font-size: 1.2em;
            font-weight: 600;
            box-shadow: 0 4px 12px rgba(39,174,96,.3);
        }
        nav { position: fixed; top: 0; left: 0; right: 0; height: 3em; padding: 0 0.8em; background: white; box-shadow: 0 2px 8px rgba(0,0,0,0.1); z-index: 10000; }
        nav .brand { font-weight: 700; float: left; padding: 0 0.8em; color: #0074d9; position: relative; top: 50%; transform: translateY(-50%); font-size: 1.1em; }
        .footer { background: #2c3e50; color: white; text-align: center; padding: 2.5em; margin-top: 4em; }
        @media (max-width: 768px) {
            .form-grid { grid-template-columns: 1fr; }
            .portal-header h1 { font-size: 1.8em; }
        }
    </style>
</head>
<body>
    <nav>
        <div class="brand">üõçÔ∏è Shop Portal</div>
    </nav>

    <div class="breadcrumb">
        <a href="/shops">‚Üê Back to Shops</a>
    </div>

    <header class="portal-header">
        <h1>üìã Shop Inquiry Form</h1>
        <p>Let us know about your interest in leasing a shop</p>
    </header>

    <main class="main-content">
        <div class="content-container">
            <div class="form-grid">
                <!-- Form Section -->
                <div class="form-card">
                    <h2 style="margin-top: 0;">Your Information</h2>
                    <form id="leadForm">
                        <div class="form-group">
                            <label for="shop">Select Shop *</label>
                            <select id="shop" name="shop" required>
                                <option value="">-- Choose a Shop --</option>
                                {% for shop in shops %}
                                    <option value="{{ shop.name }}" {% if shop.name == selected_shop %}selected{% endif %}>
                                        {{ shop.shop_name or shop.shop_number }} ({{ shop.airport }})
                                    </option>
                                {% endfor %}
                            </select>
                        </div>

                        <div class="form-group">
                            <label for="full_name">Full Name *</label>
                            <input type="text" id="full_name" name="full_name" placeholder="Your Full Name" required>
                        </div>

                        <div class="form-group">
                            <label for="email">Email Address *</label>
                            <input type="email" id="email" name="email" placeholder="your.email@example.com" required>
                        </div>

                        <div class="form-group">
                            <label for="phone">Phone Number *</label>
                            <input type="tel" id="phone" name="phone" placeholder="+91-XXXXX-XXXXX" required>
                        </div>

                        <div class="form-group">
                            <label for="company_name">Company Name</label>
                            <input type="text" id="company_name" name="company_name" placeholder="Your Company Name">
                        </div>

                        <div class="form-group">
                            <label for="message">Message / Inquiry Details</label>
                            <textarea id="message" name="message" placeholder="Tell us about your business and specific requirements..."></textarea>
                        </div>

                        <button type="submit" class="submit-btn">Submit Inquiry</button>
                        <div class="success-message" id="successMessage">
                            ‚úì Thank you! We'll be in touch soon.
                        </div>
                    </form>
                </div>

                <!-- Shop Details Sidebar -->
                <div class="shop-sidebar">
                    <h3 id="shopTitle">Selected Shop Details</h3>
                    <div id="shopDetails">
                        {% if selected_shop %}
                            <div class="shop-info-row">
                                <span class="shop-info-label">Status</span>
                                <span class="shop-info-value">
                                    <span class="status-badge status-available">Available</span>
                                </span>
                            </div>
                        {% else %}
                            <p style="color: #7f8c8d; font-size: 0.95em;">Select a shop to view details</p>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer class="footer">
        <p>&copy; 2025 Airport Shop Management. All rights reserved.</p>
    </footer>

    <script>
        var shopsData = [];
        try {
            shopsData = JSON.parse('{{ shops_json | safe }}');
            if (!Array.isArray(shopsData)) shopsData = [];
        } catch(e) {
            shopsData = [];
        }

        document.getElementById('shop').addEventListener('change', updateShopDetails);
        document.getElementById('leadForm').addEventListener('submit', handleFormSubmit);

        // Initialize with selected shop if provided
        if ('{{ selected_shop }}') {
            updateShopDetails();
        }

        function updateShopDetails() {
            const shopId = document.getElementById('shop').value;
            const shopDetailsDiv = document.getElementById('shopDetails');

            if (!shopId) {
                document.getElementById('shopTitle').textContent = 'Selected Shop Details';
                shopDetailsDiv.innerHTML = '<p style="color: #7f8c8d; font-size: 0.95em;">Select a shop to view details</p>';
                return;
            }

            const shop = shopsData.find(s => s.name === shopId);
            if (!shop) return;

            const statusClass = shop.status === 'Available' ? 'status-available' : 
                               (shop.status === 'Occupied' ? 'status-occupied' : 'status-maintenance');

            document.getElementById('shopTitle').textContent = shop.shop_name || shop.shop_number;
            shopDetailsDiv.innerHTML = `
                <div class="shop-info-row">
                    <span class="shop-info-label">Shop Number</span>
                    <span class="shop-info-value">${shop.shop_number}</span>
                </div>
                <div class="shop-info-row">
                    <span class="shop-info-label">Airport</span>
                    <span class="shop-info-value">${shop.airport || 'N/A'}</span>
                </div>
                <div class="shop-info-row">
                    <span class="shop-info-label">Area</span>
                    <span class="shop-info-value">${shop.area ? shop.area + ' sqft' : 'N/A'}</span>
                </div>
                <div class="shop-info-row">
                    <span class="shop-info-label">Monthly Rent</span>
                    <span class="shop-info-value">‚Çπ${formatCurrency(shop.rent)}</span>
                </div>
                <div class="shop-info-row">
                    <span class="shop-info-label">Status</span>
                    <span class="shop-info-value">
                        <span class="status-badge ${statusClass}">${shop.status}</span>
                    </span>
                </div>
            `;
        }

        function formatCurrency(value) {
            return parseFloat(value).toLocaleString('en-IN', {
                minimumFractionDigits: 0,
                maximumFractionDigits: 0
            });
        }

        async function handleFormSubmit(e) {
            e.preventDefault();

            // Collect the form data
            const formData = {
                shop: document.getElementById('shop').value,
                lead_name: document.getElementById('full_name').value,
                email: document.getElementById('email').value,
                phone: document.getElementById('phone').value,
                company_name: document.getElementById('company_name').value || '',
                message: document.getElementById('message').value || ''
            };

            // Show success message
            document.getElementById('leadForm').style.display = 'none';
            document.getElementById('successMessage').style.display = 'block';
            
            // Redirect after 3 seconds
            setTimeout(() => {
                window.location.href = '/shops';
            }, 3000);
        }
    </script>
</body>
</html>
